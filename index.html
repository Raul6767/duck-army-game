<script>

let money = 0;
let isWorking = false;

function updateMoneyDisplay() {
    document.getElementById("moneyDisplay").innerText = "ðŸ’° Money: $" + money;
}

function setButtonsDisabled(state) {
    const buttons = document.querySelectorAll("button");
    buttons.forEach(btn => {
        btn.disabled = state;
        btn.style.opacity = state ? "0.5" : "1";
    });
}

function startJob(jobEmoji) {

    if (isWorking) return;

    isWorking = true;
    setButtonsDisabled(true);

    const gameArea = document.getElementById("gameArea");

    let rarity;
    let minSeconds;
    let maxSeconds;
    let reward;

    const roll = Math.random();

    // Rarity system
    if (roll < 0.5) {
        rarity = "âŒ Bad";
        minSeconds = 0;
        maxSeconds = 180;
        reward = 5;
    } 
    else if (roll < 0.85) {
        rarity = "â­ Rare";
        minSeconds = 240;
        maxSeconds = 360;
        reward = 25;
    } 
    else {
        rarity = "ðŸ”¥ OP";
        minSeconds = 420;
        maxSeconds = 600;
        reward = 100;
    }

    const totalSeconds = Math.floor(Math.random() * (maxSeconds - minSeconds + 1)) + minSeconds;

    let timeLeft = totalSeconds;

    gameArea.innerHTML = `
        <div style="font-size:20px; margin-bottom:10px;">${rarity}</div>
        <div style="font-size:60px;">${jobEmoji}</div>
        <div id="countdown" style="font-size:30px; margin-top:10px;"></div>
    `;

    const countdownElement = document.getElementById("countdown");

    const timerInterval = setInterval(() => {

        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;

        const formattedTime =
            String(minutes).padStart(2, '0') +
            ":" +
            String(seconds).padStart(2, '0');

        countdownElement.innerHTML = formattedTime;

        timeLeft--;

        if (timeLeft < 0) {
            clearInterval(timerInterval);

            money += reward;
            updateMoneyDisplay();

            countdownElement.innerHTML = "âœ… Earned $" + reward;

            isWorking = false;
            setButtonsDisabled(false);
        }

    }, 1000);
}

</script>
